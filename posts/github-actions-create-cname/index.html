<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="description" content="A statically generated blog example using Next.js and Markdown."/><meta property="og:image" content="https://og-image.vercel.app/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><title>【GitHub Pages】カスタムドメインがリセットされちゃうのよぉ！</title><meta property="og:image" content="/assets/blog/dynamic-routing/cover.jpg"/><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/26ad9ed7e3f62883.css" as="style"/><link rel="stylesheet" href="/_next/static/css/26ad9ed7e3f62883.css" data-n-g=""/><link rel="preload" href="/_next/static/css/5f2690cc7943bd70.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5f2690cc7943bd70.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-514908bffb652963.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-cb34fc5807e9b27c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-57f97a3cc8323c9b.js" defer=""></script><script src="/_next/static/chunks/46-1f39ebd112a80df6.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-9bf3b66ba6449b90.js" defer=""></script><script src="/_next/static/remWQ96Te5-qevgmkU-Mo/_buildManifest.js" defer=""></script><script src="/_next/static/remWQ96Te5-qevgmkU-Mo/_ssgManifest.js" defer=""></script><script src="/_next/static/remWQ96Te5-qevgmkU-Mo/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen"><div class="border-b bg-accent-1 border-accent-2"><div class="container mx-auto px-5"><div class="py-2 text-center text-sm">The source code for this blog is<!-- --> <a href="https://github.com/vercel/next.js/tree/canary/examples/blog-starter-typescript" class="underline hover:text-success duration-200 transition-colors">available on GitHub</a>.</div></div></div><main><div class="container mx-auto px-5"><h2 class="text-2xl md:text-4xl font-bold tracking-tight md:tracking-tighter leading-tight mb-20 mt-8"><a class="hover:underline" href="/">RTF</a></h2><article class="mb-32"><h1 class="text-6xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left">【GitHub Pages】カスタムドメインがリセットされちゃうのよぉ！</h1><div class="hidden md:block md:mb-12"><div class="flex items-center"><img src="/assets/blog/authors/jj.jpeg" class="w-12 h-12 rounded-full mr-4" alt="Pento"/><div class="text-xl font-bold">Pento</div></div></div><div class="mb-8 md:mb-16 sm:mx-0"><div class="sm:mx-0"><img src="/assets/blog/dynamic-routing/cover.jpg" alt="Cover Image for 【GitHub Pages】カスタムドメインがリセットされちゃうのよぉ！" class="shadow-small"/></div></div><div class="max-w-2xl mx-auto"><div class="block md:hidden mb-6"><div class="flex items-center"><img src="/assets/blog/authors/jj.jpeg" class="w-12 h-12 rounded-full mr-4" alt="Pento"/><div class="text-xl font-bold">Pento</div></div></div><div class="mb-6 text-lg"><time dateTime="2022-03-26T05:35:07.322Z">March	26, 2022</time></div></div><div class="max-w-2xl mx-auto"><div class="markdown-styles_markdown__h_8de"><p>このブログはGitHub Pagesを利用して配信しているのですが、配信するたびにカスタムドメイン設定がリセットされるため困っていました。
再設定は簡単なのでまあいいかと思っていましたが、記事の投稿、サイトの改修頻度が上がるにつれて煩わしくなってきたのでようやく重い腰を上げて修正しました。</p>
<p>下記のように毎度設定が空に
<img src="/assets/blog/github-actions-create-cname/github-actions-create-cname_1.png" alt="GitHub Pagesセッティング"></p>
<p>そもそも都度設定をしなきゃいけないわけないので確実に設定漏れ。とりあえずGitHub Pagesの<a href="https://docs.github.com/ja/pages/configuring-a-custom-domain-for-your-github-pages-site/troubleshooting-custom-domains-and-github-pages">トラブルシューティング</a>を確認</p>
<p><img src="/assets/blog/github-actions-create-cname/github-actions-create-cname_2.png" alt="GitHubリファレンス"></p>
<p>ど頭にあったw 確認ミスも確認ミス。</p>
<blockquote>
<p>サイトが正しいドメインをレンダリングするには、CNAME ファイルがまだリポジトリに存在していることを確認します。 たとえば、静的サイトジェネレータの多くはリポジトリへのプッシュを強制するので、カスタムドメインの設定時にリポジトリに追加された CNAME ファイルを上書きすることができます。 ローカルでサイトをビルドし、生成されたファイルを GitHub にプッシュする場合は、CNAME ファイルをローカルリポジトリに追加したコミットを先にプルして、そのファイルがビルドに含まれるようにする必要があります。</p>
</blockquote>
<p>とりあえずCNAMEファイルというのが生成されて、GitHub Pages対象のブランチ(デフォルトはgh-pages)に存在する必要があるみたい。</p>
<p><img src="/assets/blog/github-actions-create-cname/github-actions-create-cname_3.png" alt="GitHubリポジトリ"></p>
<p>ホントだ。ない...</p>
<p><img src="/assets/blog/github-actions-create-cname/github-actions-create-cname_4.png" alt="GitHubコミット履歴"></p>
<p>コミット履歴にはある...</p>
<p><img src="/assets/blog/github-actions-create-cname/github-actions-create-cname_5.png" alt="GitHubコミット履歴詳細"></p>
<p>純粋にCNAMEというファイル名にドメイン記載したものがgh-pagesブランチにあれば良いのか</p>
<blockquote>
<p>CNAMEファイルをローカルリポジトリに追加したコミットを先にプルして、そのファイルがビルドに含まれるようにする必要があります。</p>
</blockquote>
<p>の部分がGitHub Actions内でやらなくてはならない感じもするけど、とりあえずファイル存在すればOKでしょうということで作成して普通にmerge</p>
<p>このサイトはNEXT.jsのブログテンプレートを利用しているのでpublic/配下に配置すれば静的ファイルとしてデプロイ後のルートディレクトリに配置されるはず</p>
<p><img src="/assets/blog/github-actions-create-cname/github-actions-create-cname_6.png" alt="GitHubリポジトリ設定後">
OK！</p>
<p><img src="/assets/blog/github-actions-create-cname/github-actions-create-cname_7.png" alt="GitHub Pagesセッティング後">
設定の方もOK</p>
<p>まとめ
GitHubのトラブルシューティングは優秀</p>
</div></div></article></div></main></div><footer class="bg-accent-1 border-t border-accent-2"><div class="container mx-auto px-5"><div class="py-28 flex flex-col lg:flex-row items-center"><h3 class="text-4xl lg:text-5xl font-bold tracking-tighter leading-tight text-center lg:text-left mb-10 lg:mb-0 lg:pr-4 lg:w-1/2">Statically Generated with Next.js.</h3><div class="flex flex-col lg:flex-row justify-center items-center lg:pl-4 lg:w-1/2"><a href="https://nextjs.org/docs/basic-features/pages" class="mx-3 bg-black hover:bg-white hover:text-black border border-black text-white font-bold py-3 px-12 lg:px-8 duration-200 transition-colors mb-6 lg:mb-0">Read Documentation</a><a href="https://github.com/vercel/next.js/tree/canary/examples/blog-starter-typescript" class="mx-3 font-bold hover:underline">View on GitHub</a></div></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"【GitHub Pages】カスタムドメインがリセットされちゃうのよぉ！","date":"2022-03-26T05:35:07.322Z","slug":"github-actions-create-cname","author":{"name":"Pento","picture":"/assets/blog/authors/jj.jpeg"},"content":"\u003cp\u003eこのブログはGitHub Pagesを利用して配信しているのですが、配信するたびにカスタムドメイン設定がリセットされるため困っていました。\n再設定は簡単なのでまあいいかと思っていましたが、記事の投稿、サイトの改修頻度が上がるにつれて煩わしくなってきたのでようやく重い腰を上げて修正しました。\u003c/p\u003e\n\u003cp\u003e下記のように毎度設定が空に\n\u003cimg src=\"/assets/blog/github-actions-create-cname/github-actions-create-cname_1.png\" alt=\"GitHub Pagesセッティング\"\u003e\u003c/p\u003e\n\u003cp\u003eそもそも都度設定をしなきゃいけないわけないので確実に設定漏れ。とりあえずGitHub Pagesの\u003ca href=\"https://docs.github.com/ja/pages/configuring-a-custom-domain-for-your-github-pages-site/troubleshooting-custom-domains-and-github-pages\"\u003eトラブルシューティング\u003c/a\u003eを確認\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/blog/github-actions-create-cname/github-actions-create-cname_2.png\" alt=\"GitHubリファレンス\"\u003e\u003c/p\u003e\n\u003cp\u003eど頭にあったw 確認ミスも確認ミス。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eサイトが正しいドメインをレンダリングするには、CNAME ファイルがまだリポジトリに存在していることを確認します。 たとえば、静的サイトジェネレータの多くはリポジトリへのプッシュを強制するので、カスタムドメインの設定時にリポジトリに追加された CNAME ファイルを上書きすることができます。 ローカルでサイトをビルドし、生成されたファイルを GitHub にプッシュする場合は、CNAME ファイルをローカルリポジトリに追加したコミットを先にプルして、そのファイルがビルドに含まれるようにする必要があります。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eとりあえずCNAMEファイルというのが生成されて、GitHub Pages対象のブランチ(デフォルトはgh-pages)に存在する必要があるみたい。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/blog/github-actions-create-cname/github-actions-create-cname_3.png\" alt=\"GitHubリポジトリ\"\u003e\u003c/p\u003e\n\u003cp\u003eホントだ。ない...\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/blog/github-actions-create-cname/github-actions-create-cname_4.png\" alt=\"GitHubコミット履歴\"\u003e\u003c/p\u003e\n\u003cp\u003eコミット履歴にはある...\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/blog/github-actions-create-cname/github-actions-create-cname_5.png\" alt=\"GitHubコミット履歴詳細\"\u003e\u003c/p\u003e\n\u003cp\u003e純粋にCNAMEというファイル名にドメイン記載したものがgh-pagesブランチにあれば良いのか\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCNAMEファイルをローカルリポジトリに追加したコミットを先にプルして、そのファイルがビルドに含まれるようにする必要があります。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eの部分がGitHub Actions内でやらなくてはならない感じもするけど、とりあえずファイル存在すればOKでしょうということで作成して普通にmerge\u003c/p\u003e\n\u003cp\u003eこのサイトはNEXT.jsのブログテンプレートを利用しているのでpublic/配下に配置すれば静的ファイルとしてデプロイ後のルートディレクトリに配置されるはず\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/blog/github-actions-create-cname/github-actions-create-cname_6.png\" alt=\"GitHubリポジトリ設定後\"\u003e\nOK！\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/blog/github-actions-create-cname/github-actions-create-cname_7.png\" alt=\"GitHub Pagesセッティング後\"\u003e\n設定の方もOK\u003c/p\u003e\n\u003cp\u003eまとめ\nGitHubのトラブルシューティングは優秀\u003c/p\u003e\n","ogImage":{"url":"/assets/blog/dynamic-routing/cover.jpg"},"coverImage":"/assets/blog/dynamic-routing/cover.jpg"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"github-actions-create-cname"},"buildId":"remWQ96Te5-qevgmkU-Mo","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>